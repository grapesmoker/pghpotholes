<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
	{%load staticfiles %}
	<link rel="stylesheet" type="text/css" href="../static/css/transperia.css" media="screen"/>
    <style type="text/css">
      html { height: 100% }
      body { height: 100%; margin: 0; padding: 0 }
      #map-canvas { height: 100%; width: 100% }
      #map-container { height: 400px; width: 100% }
	  #pothole-picture { max-height: 100%; max-width: 100%; height: 100% }
	  #pothole-picture-container { height: 150px; text-align: center } 
	  #content { width: 500px; margin-left: auto; margin-right:auto }
    </style>
	<script src="../static/js/jquery-1.10.1.js"></script>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?sensor=false">
    </script>
    <script type="text/javascript">
	var pothole_data = [
		{ coordinate_lat: 40.44959, coordinate_long: -79.943673,
		  img_src: "https://pbs.twimg.com/media/BLsXD42CcAAKbqO.jpg:small",
		  id: "pothole1"
		  },
		{ coordinate_lat: 40.44450, coordinate_long: -79.941779,
		  img_src: "http://cvcl.mit.edu/hybrid/cat2.jpg",
		  id: "pothole2"
		  }
		]
	var kmlLayer = new google.maps.KmlLayer(null);
	$(document).ready(function() {
		<!--var map = L.map('map-canvas').setView([40.44956, -79.941673], 13);-->
		var mapOptions = {
			center: new google.maps.LatLng(40.440625, -79.970886),
			zoom: 12,
			mapTypeId: google.maps.MapTypeId.ROADMAP
		};
		var map = new google.maps.Map(document.getElementById("map-canvas"),
			mapOptions);

		var infowindow = new google.maps.InfoWindow({"maxWidth":200});

		function createListener(marker, pothole) {
			google.maps.event.addListener(marker, 'click', function() {
				infowindow.setContent("<div style='height: 100px; width: 100px'><img src=\"" + pothole.img_src + "\" height='100%' /></div>");
				infowindow.open(map, marker);
				$("#pothole-picture").attr("src", pothole.img_src);
			});
		}

		pothole_data.forEach( function( pothole ) {
		  var marker = new google.maps.Marker({
			position: new google.maps.LatLng(pothole.coordinate_lat, pothole.coordinate_long),
			map: map
		  });
		  createListener(marker, pothole);
		});

		$(':input[name=overlays]').each( function () {
			$(this).change( function () {
				if ($(this).prop("checked"))
				{
					kmlLayer.setMap(null);
					kmlLayer = new google.maps.KmlLayer($(this).attr("value"));
					kmlLayer.setMap(map);
				}
			});
		});
	});
	
    </script>
  </head> 
  <body>
	<div class="container">
	
		<div class="main">

			<div class="header">
				<div class="title">
					<h1>PghPotholes</h1>
				</div>
			</div>
			
			<div class="content">
				<div class="item">
					<h2>Pothole Map:</h2>
					<div id="map-container">
						<div id="map-canvas" ></div>
					</div>
				</div>
			</div>
			<div class="sidenav">
				<h1>Navigation</h1>
				<ul>
					<li>
						<a href=pothole.html>Home</a>
					</li>
					<li>
						<a href=about.html>About Us</a
					</li>
				</ul>
				<h1>Overlays</h1>
				<ul>
					<li>
						<form>
							<input type="radio" name="overlays" id="no-overlays-checkbox" checked="checked"/>
							<label for="no-overlays-checkbox">No Overlay</label>
							<br/>
							<input type="radio" name="overlays" id="voting-checkbox" value="{{ STATIC_URL }}/Council_District2012.kml" />
							<label for="voting-checkbox">Voting</label>
							<br/>
							<input type="radio" name="overlays" id="income-checkbox"/>
							<label for="income-checkbox">Median Income</label>
							<br/>
							<input type="radio" name="overlays" id="bus-checkbox" value="{{ STATIC_URL }}/Bus_Routes.kml"/>
							<label for="bus-checkbox">Bus Routes</label>
							<br/> 
							<input type="radio" name="overlays" id="chicago-checkbox" value="http://gmaps-samples.googlecode.com/svn/trunk/ggeoxml/cta.kml"/>
							<label for="chicago-checkbox">Chi-town</label>
						</form>
					</li>
				</ul>
			</div>
			<div class="clearer"><span></span></div>

		</div>

		<div class="footer">&copy; 2013 <a href="index.html">pghpotholes.com</a>. Valid <a href="http://jigsaw.w3.org/css-validator/check/referer">CSS</a> &amp; <a href="http://validator.w3.org/check?uri=referer">XHTML</a>. Template design by <a href="http://templates.arcsin.se">Arcsin</a>
		</div>
	</div>
  </body>
</html>